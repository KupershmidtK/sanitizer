#define DOCTEST_CONFIG_IMPLEMENT_WITH_MAIN
#include <doctest.h>
#include <sanitizer.h>
#include <pthread.h>

static pthread_mutex_t m1;
// static pthread_mutex_t m2;
// static pthread_mutex_t m3;

void* thread_func(void* arg) {
    (void)arg;
    // pthread_mutex_lock(&m1);
    pthread_mutex_lock(&m1);
    pthread_mutex_unlock(&m1);
    // pthread_mutex_unlock(&m1);
    return nullptr;
}

TEST_CASE("inject test") { 
    pthread_t th1;
    pthread_create(&th1, NULL, thread_func, NULL);
    pthread_join(th1, NULL);

    CHECK(4 == 4); 
}
